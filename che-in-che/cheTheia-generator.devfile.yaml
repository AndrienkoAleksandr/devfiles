# A devfile to work on the che-theia generator
# For developers who work on Theia core or che-theia core extensions and plugins.

specVersion: 0.0.1
name: cheTheiaGenerator-in-che
projects:
  - name: che-theia
    source:
      type: git
      location: 'https://github.com/eclipse/che-theia.git'
  - name: theia
    source:
      type: git
      location: 'https://github.com/theia-ide/theia.git'
  - name: che-theia-generator
    source:
      type: git
      location: 'https://github.com/sunix/che-theia-generator.git'
      branch: plugin-folders
components:
  -
    type: cheEditor
    id: org.eclipse.che.editor.theia:next
  -
    type: chePlugin
    id: che-machine-exec-plugin:0.0.1
  -
    type: dockerimage
    image: sunix/git-devtools
    mountSources: true
    memoryLimit: 256M
  -
    alias: che-dev
    type: chePlugin
    id: org.eclipse.che.theia.dev:0.0.1
  -
    type: chePlugin
    id: redhat.vscode-yaml:0.3.0
  -
    type: chePlugin
    id: ms-vscode.typescript:1.30.2
    memoryLimit: 2048M
commands:
  -
    name: init (built from source)... che-theia
    actions:
      - type: exec
        component: che-dev
        command: >
                 /projects/che-theia-generator/dist/index.js init --dev &&
                 echo -e "\e[32mDone.\e[0m che:theia init"
        workdir: /projects/theia
  -
    name: init (built from source) -C /projects/che-theia/extensions/extensions.yml... che-theia
    actions:
      - type: exec
        component: che-dev
        command: >
                 /projects/che-theia-generator/dist/index.js init --dev -c /projects/che-theia/extensions/extensions.yml &&
                 echo -e "\e[32mDone.\e[0m che:theia init"
        workdir: /projects/theia
  -
    name: clean (built from source)... che-theia
    actions:
      - type: exec
        component: che-dev
        command: >
                 /projects/che-theia-generator/dist/index.js clean &&
                 echo -e "\e[32mDone.\e[0m che:theia clean"
        workdir: /projects/theia
  -
    name: build ... che-theia-generator
    actions:
      - type: exec
        component: che-dev
        command: >
                 killall node;
                 yarn &&
                 echo -e "\e[32mDone.\e[0m build ... che-theia-generator"
        workdir: /projects/che-theia-generator
  -
    name: test-watch ... che-theia-generator
    actions:
      - type: exec
        component: che-dev
        command: >
                 killall node;
                 yarn test-watch
        workdir: /projects/che-theia-generator
